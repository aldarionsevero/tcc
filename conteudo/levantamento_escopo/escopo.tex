\section{Escopo de Implementação}
\label{sec:escopo}


O Cupper se encaixa na categoria de ferramentas \textit{CLI} (\textit{Command-line Interface})
e como descrito na Seção~\ref{sec:supdev:rubygems}, será construída nos padrões de
RubyGems que permite criar os comandos por meio de arquivos de \textit{script bash}
que serão instalados, por padrão do gerenciado de pacote, no diretório de binários do sistema.
Os comandos serão chamados pelo prefixo \textit{cupper} seguido da funcionalidade e as opções.

%TODO: colocar a estrutura de init do Cupper e mostrar como será a distribuição dos arquivos e diretórios.

Em resumo da Seção~\ref{sec:lev-rec}, os recursos Chef com relação aos \textit{coookbooks} que serão utilizados.

\subsection{Funcionalidades}

\begin{enumerate}
  \item \textbf{Mostrar Ajuda}: imprime no terminal os principais comandos e as opções válidas de
    cada uma;

  \item \textbf{Gerar Cookbook}: extrai as configurações do ambiente e cria o \textit{cookbook} correspondente.
    Esse \textit{cookbook} será inserido no diretório \textit{cookbooks} na raiz do projeto Cupper.
    A Figura~\ref{fig:cupper_geral} mostra o fluxo básico dessa funcionalidade;

  \item \textbf{Mostrar Extrações}: mostra as extrações realizadas pelo Cupper em conjunto com o Ohai,
    ou seja, é a forma intermediária à criação dos \textit{cookbooks} onde serão mostrados os outputs do
    sistema e o reflexo deles no \textit{cookbook} antes da criação em sí;

  \item \textbf{Gerar Projeto Cupper}: gera a estrutura de diretório padrão para o projeto Cupper.
    Um projeto Cupper contém o conjunto de \textit{plugins} do Ohai e Cupper, arquivos de configurações
    específicos do projeto e um conjunto de diretórios onde serão dispostos as configurações
    extraídas e os \textit{cookbooks} gerados do ambiente;

  \item \textbf{Listar \textit{Plugins}}: lista os plugins disponíveis do Ohai, tanto os padrões, já inclusos
    na instalação do Ohai, quanto os customizados pelo Cupper;

\end{enumerate}

\subsection{Estrutura e Módulos}

A Figura~\ref{fig:cupper-detail} mostra a Estrutura Inicial Planejada para os 
Módulos do Cupper.

\begin{figure}[H]
  \centering
  \includegraphics[width=1.05\textwidth]{figuras/cupper_detail.eps}
  \caption{Estrutura Inicial Planejada para os Módulos do Cupper}
  \label{fig:cupper-detail}
\end{figure}

A imagem descreve o seguinte fluxo:

\begin{enumerate}
    \item Executa-se o Cupper em um ambiente do qual deseja-se extrair configurações.
    \item O Ohai irá extrair atributos referentes às camadas de \textit{Hardware},
\textit{Service} e \textit{Operating System}.
    \item \textit{Plugins do Ohai} irão adicionar a capacidade de extrair atributos da
camada de \textit{Custom} e \textit{Application}. Também adicionam a capacidade
de extrair outros atributos das outras camadas.
    \item Esses atributos são retornados em formato JSON para o processamento
do Cupper.
    \item O Coletor processa esse JSON, extrai os dados úteis, e organiza
por suas camadas.
    \item \textit{Custom Plugins} podem ser adicionados para que o coletor
processe outros tipos de atributos.
    \item Esses dados são passados para o Manager que gera um relatório semelhante
ao do Ohai, mas mais completo se houver presença de \textit{plugins}.
    \item O manager então passa esses dados para os builders que constroem
\textit{cookbooks} por suas partes (\textit{Recipes, Template e File})
    \item \textit{Custom Plugins} podem ser adicionados, para construir
\textit{cookbooks} de maneira diferente, considerando os \textit{custom plugins}
adicionados também à coleta.
    \item Por fim uma \textit{cookbook} é gerada, e poderá ser usada como 
entrada para o Chef reproduzir essa configuração em uma máquina não
configurada.
\end{enumerate}
